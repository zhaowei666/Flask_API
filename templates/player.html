<html lang="en">
<head>
  <title>Bootstrap Example</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>
<body onload="tableOnload('{{ info['num_logs'] }}')">
  <div class="container">
    <div style="width: 50%; float:left">
      <h2>Select player</h2>
      <select class="form-control" id="player_selection">
        {% for name in names %}
          <option>{{ name }}</option>
        {% endfor %}
      </select>
      <a href="javascript:displayPlayers($('#player_selection').val())" class="btn btn-success" role="button">Submit</a>
    </div>
  </div>
  <div class="container">
    <h2>Profile</h2>
    <table class="table">
      <tr>
        <th class="col-sm-3 info">Name</th>
        <td class="col-sm-7 active"><span id="name">{{ info['profile']['name'] }}</span></td>
      </tr>
      <tr>
        <th class="info">Player ID</th>
        <td><span id="id">{{ info['profile']['id'] }}</span></td>
      </tr>
      <tr>
        <th class="info">Date of Birth</th>
        <td class="active"><span id="date_of_birth">{{ info['profile']['date_of_birth'] }}</span></td>
      </tr>
      <tr>
        <th class="info">Drafted</th>
        <td><span id="draft">{{ info['profile']['draft'] }}</span></td>
      </tr>
    </table>
  </div>
  <div class="container">
    <h2>Stats</h2>
    <table class="table table-striped table-condensed">
      <thead>
        <tr class="info">
          <th class="col-sm-1"></th>
          <th class="col-sm-1">Attempts</th>
          <th class="col-sm-1">Completions</th>
          <th class="col-sm-1">Completion%</th>
          <th class="col-sm-1">Yards</th>
          <th class="col-sm-1">TouchDowns</th>
          <th class="col-sm-1">Interceptions</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>Season</th>
          <td id="attempts_all">{{ info['stats']['all']['attempts'] }}</td>
          <td id="completions_all">{{ info['stats']['all']['completions'] }}</td>
          <td id="completion_rate_all">{{ info['stats']['all']['completion_rate'] }}</td>
          <td id="yards_all">{{ info['stats']['all']['yards'] }}</td>
          <td id="touchdowns_all">{{ info['stats']['all']['touchdowns'] }}</td>
          <td id="interceptions_all">{{ info['stats']['all']['interceptions'] }}</td>
        </tr>
        <tr>
          <th>Match Average</th>
          <td id="attempts_match">{{ info['stats']['match']['attempts'] }}</td>
          <td id="completions_match">{{ info['stats']['match']['completions'] }}</td>
          <td id="completion_rate_match"></td>
          <td id="yards_match">{{ info['stats']['match']['yards'] }}</td>
          <td id="touchdowns_match">{{ info['stats']['match']['touchdowns'] }}</td>
          <td id="interceptions_match">{{ info['stats']['match']['interceptions'] }}</td>
        </tr>
      </tbody>

    </table>
  </div>
  <div class="container">
    <h2>Game Log</h2>
    <table class="table table-striped">
      <thead>
        <tr class="info">
          <th class="col-sm-1">Week</th>
          <th class="col-sm-2">Opponent</th>
          <th class="col-sm-1">Home</th>
          <th class="col-sm-1">Attempts</a></th>
          <th class="col-sm-1">Completions</th>
          <th class="col-sm-1">Completion%</th>
          <th class="col-sm-1">Yards</th>
          <th class="col-sm-1">TouchDowns</th>
          <th class="col-sm-1">Interceptions</th>
        </tr>
      </thead>
      <tbody>
        {% for i in range(100)%}
          {% if i < info['num_logs'] %}
            <tr id="log{{ i }}">
              <td><span id="week_{{ i }}">{{ info['game_logs'][i]['week'] }}</span></td>
              <td><span id="opponent_{{ i }}">{{ info['game_logs'][i]['opponent'] }}</span></td>
              <td><span id="home_{{ i }}">{{ info['game_logs'][i]['home'] }}</span></td>
              <td><span id="attempts_{{ i }}">{{ info['game_logs'][i]['attempts'] }}</span></td>
              <td><span id="completions_{{ i }}">{{ info['game_logs'][i]['completions'] }}</span></td>
              <td><span id="completion_rate">{{ info['game_logs'][i]['completion_rate'] }}</span></td>
              <td><span id="yards_{{ i }}">{{ info['game_logs'][i]['yards'] }}</span></td>
              <td><span id="touchdowns_{{ i }}">{{ info['game_logs'][i]['touchdowns'] }}</span></td>
              <td><span id="interceptions_{{ i }}">{{ info['game_logs'][i]['interceptions'] }}</span></td>
            </tr>
          {% else %}
             <tr id="log{{ i }}">
              <th><span id="week_{{ i }}"></span></th>
              <th><span id="opponent_{{ i }}"></span></th>
              <th><span id="home_{{ i }}"></span></th>
              <th><span id="attempts_{{ i }}"></span></th>
              <th><span id="completions_{{ i }}"></span></th>
              <th><span id="completion_rate"></span></th>
              <th><span id="yards_{{ i }}"></span></th>
              <th><span id="touchdowns_{{ i }}"></span></th>
              <th><span id="interceptions_{{ i }}"></span></th>
             </tr>
          {% endif %}
        {% endfor %}
      </tbody>
    </table>
  </div>
</body>
</html>
<script>
  function displayPlayers(name) {
      $.post('/update_player', {
          name: name
      }).done(function(update_player) {
          for (var x in update_player['profile']) {
              $('#'+x).text(update_player['profile'][x])
          }

          for (var x in update_player['stats']['all']) {
              $('#'+x+'_all').text(update_player['stats']['all'][x])
          }
          for (var x in update_player['stats']['match']) {
              $('#'+x+'_match').text(update_player['stats']['match'][x])
          }

          for (var i=0; i < 100; i++) {
              if (i < update_player['num_logs']) {
                  $('#log' + i).show();
                  if (i % 2 == 1) {
                      $('#log' + i).removeClass().addClass('active')
                  }
                  for (var x in update_player['game_logs'][i]) {
                      $('#'+x+'_'+i).text(update_player['game_logs'][i][x])
                  }
              } else {
                  $('#log' + i).hide()
              }
          }
      })
  }
  function tableOnload(numLogs) {
      for (var i = 0; i < 100; i++) {
          if (i < numLogs) {
              $('#log' + i).show();
          } else {
              $('#log' + i).hide()
          }
      }
  }
</script>
